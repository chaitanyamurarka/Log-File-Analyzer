<!DOCTYPE html>
<html>
<head>
    <title>Analysis Results</title>
</head>
<body>
    <h1>Analysis Results</h1>
    
    <h2>IP Address Request Count:</h2>
    <ul>
        {% for ip, count in results.sorted_ip_counts %}
            <li>{{ ip }}: {{ count }}</li>
        {% endfor %}
    </ul>

    <h2>Most Frequently Accessed Endpoint:</h2>
    {% if results.most_accessed_endpoint %}
        <p>{{ results.most_accessed_endpoint[0] }} (Accessed {{ results.most_accessed_endpoint[1] }} times)</p>
    {% else %}
        <p>No endpoint data available.</p>
    {% endif %}

    <h2>Suspicious Activity:</h2>
    {% if results.suspicious_ips %}
        <ul>
            {% for ip, count in results.suspicious_ips %}
                <li>{{ ip }}: {{ count }} failed login attempts</li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No suspicious activity detected.</p>
    {% endif %}

    <a href="{{ url_for('download_file', filename='log_analysis_results.csv') }}">Download Results CSV</a>
</body>
</html>
